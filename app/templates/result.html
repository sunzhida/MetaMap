<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../static/img/favicon.ico">

    <title>MIM</title>

    <!-- Bootstrap core CSS -->
    <link href="../static/css/bootstrap.css" rel="stylesheet">
    <link href="../static/css/jquery-ui.min.css" rel="stylesheet">
    <!--    <link href="../static/css/style.min.css" rel="stylesheet">-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"
          integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">

    <!-- Custom styles for this template -->
    <link href="../static/css/cover.css" rel="stylesheet">
    <link href="../static/css/template.css" rel="stylesheet">
</head>

<body>

<main role="main" class="container-fluid">

    <div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">
        <header class="masthead mb-3">
            <div class="inner">
                <h3 class="masthead-brand">
                    <a href="/">Metaphoraction</a>
                </h3>
                <nav class="nav nav-masthead justify-content-center">
                    <a class="nav-link active" href="#">Result</a>
                    {% if g.user %}
                        <a class="nav-link">{{ g.user[1] }}</a>
                        <a class="nav-link" href="{{ url_for('logout') }}">Log out</a>
                    {% else %}
                        <a class="nav-link" href="/login">Sign in</a>
                        <a class="nav-link" href="/register">Sign up</a>
                    {% endif %}
                </nav>
            </div>
        </header>

        <main role="main" class="inner cover">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-8">
                        <div class="card bg-light">
                            <div class="card-body" style="padding-top: 15px; padding-bottom: 6px;">
                                <small class="text-muted">Please filling in any blanks in the following query. An
                                    example query: "To <b><i>cover</i></b> the device, as to <b><i>grasp</i></b>
                                    <b><i>butterfly</i></b>,
                                    could represent <b><i>love</i></b>".
                                </small>
                                <form class="input-group" action="{{ url_for('result') }}" method="post">
                                    <label class="col-form-label">To&nbsp;</label>
                                    <label style="width: 13%"><input id='interaction' type="text" class="form-control"
                                                                     placeholder="" aria-label="Interaction"
                                                                     name="interaction">&nbsp;
                                        <small><em class="text-muted">E.g., cover</em></small>
                                    </label>
                                    <label class="col-form-label">&nbsp;the device, as to&nbsp;</label>
                                    <label style="width: 13%"><input id='action' type="text" class="form-control"
                                                                     placeholder="" aria-label="Action" name="action">
                                        <small><em class="text-muted">E.g., grasp</em></small>
                                    </label>
                                    &nbsp;
                                    <label style="width: 13%">
                                        <input id='entity' type="text" class="form-control"
                                               placeholder="" aria-label="Entity" name="entity">
                                        <small><em class="text-muted">E.g., butterfly</em></small>
                                    </label>
                                    <label class="col-form-label">, could represent&nbsp;</label>
                                    <label style="width: 13%"><input id='mean' type="text" class="form-control"
                                                                     placeholder="" aria-label="Mean" name="mean">
                                        <small><em class="text-muted">E.g., love</em></small>
                                    </label>
                                    <div class="input-group-append"
                                         style="height: calc(1.5em + 0.75rem + 2px); width: 13%">
                                        <input style="width: 100%;" class="btn btn-outline-success" type="submit"
                                               onclick="recordData()"
                                               value="Search"/>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <div id="vis"></div>
                        <div>
                            <small><b>Annotation</b>
                                <object type="image/svg+xml" data="static/img/icon_grey/gesture.svg">
                                    <!-- Your fall back here -->
                                    <img src="static/img/icon_grey/gesture.svg"/>
                                </object>: Vision based;
                                <object type="image/svg+xml" data="static/img/icon_grey/touch.svg">
                                    <!-- Your fall back here -->
                                    <img src="static/img/icon_grey/touch.svg" y="5"/>
                                </object>: Touch based;
                                <object type="image/svg+xml" data="static/img/icon_grey/device.svg">
                                    <!-- Your fall back here -->
                                    <img src="static/img/icon_grey/device.svg"/>
                                </object>: Device based
                                <object type="image/svg+xml" data="static/img/icon_grey/single.svg">
                                    <!-- Your fall back here -->
                                    <img src="static/img/icon_grey/single.svg"/>
                                </object>: Single hand
                                <object type="image/svg+xml" data="static/img/icon_grey/double.svg">
                                    <!-- Your fall back here -->
                                    <img src="static/img/icon_grey/double.svg"/>
                                </object>: Double hand
                            </small>
                        </div>
                    </div>
                    <div class="col-4">
                        <div class="card mb-1">
                            <div class="card-header">Control Panel</div>
                            <div class="card-body">
                                <div id="number" class="text-left">
                                    <p>
                                        <small>There are total {{ rows }} candidates by searching
                                            {% if result['interaction'] != '' %}
                                                "{{ result['interaction'] }}"
                                            {% endif %}
                                            {% if result['action'] != '' %}
                                                "{{ result['action'] }}"
                                            {% endif %}
                                            {% if result['entity'] != '' %}
                                                "{{ result['entity'] }}"
                                            {% endif %}
                                            {% if result['mean'] != '' %}
                                                "{{ result['mean'] }}"
                                            {% endif %}
                                        </small>
                                    </p>
                                    <div id="slider" class="mb-1">
                                        <div id="custom-handle" class="ui-slider-handle"></div>
                                    </div>
                                    <div class="text-center">
                                        <small class="text-muted">Slide the bar to browse the other 50 candidates
                                        </small>
                                    </div>
                                </div>
                                <hr>
                                <div>
                                    <span>Nodes Browsing History</span>
                                    <button type="button" class="btn btn-outline-secondary float-right"
                                            onclick="clearNode()">
                                        <i class="fas fa-eraser"></i> Clear History
                                    </button>
                                </div>
                                <div id="selected" class="mt-3">
                                    <div id="i_group">
                                        <small>Gesture:</small>
                                    </div>
                                    <div id="a_group">
                                        <small>Action:</small>
                                    </div>
                                    <div id="e_group">
                                        <small>Entity:</small>
                                    </div>
                                    <div id="m_group">
                                        <small>Meaning:</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card bg-light mb-1">
                            <div class="card-body" id="filter">
                                <span style="position: absolute; padding-top: 8px">Node Operation</span>
                                <div class="btn-group float-right" role="group">
                                    <button type="button" class="btn btn-outline-secondary" onclick="pinNode()"><i
                                            class="fas fa-thumbtack"></i> Pin
                                    </button>
                                    <button type="button" class="btn btn-outline-secondary" onclick="removeNode()"><i
                                            class="fas fa-trash-alt"></i> Remove
                                    </button>
                                    <button type="button" class="btn btn-outline-secondary" onclick="redoNode()"><i
                                            class="fas fa-undo"></i> Undo
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="card" id="down_card">
                            <div class="card-header" id="explore">Description</div>
                            <div class="card-body">
                                <div id="meta" style="min-height: 264px"></div>
                            </div>
                        </div>

                    </div>
                    {#                    <div id="tree" class="col-4"></div>#}
                </div>
            </div>
        </main>

        <footer class="mastfoot mt-auto">
            <div class="text-center">
                <p>Copyright © HKUST HCI Initiative</p>
            </div>
        </footer>
    </div>

</main><!-- /.container -->

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
{#<script src="../static/js/vendor/jquery-3.4.1.min.js"></script>#}
<script src="../static/js/vendor/popper.min.js"></script>
<script src="../static/js/bootstrap.min.js"></script>
<script src="../static/js/vendor/jquery-ui.min.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="../static/js/d3.layout.cloud.js"></script>
<script src="../static/js/vendor/textures.js"></script>
<script type="text/javascript">
    function passData(vars) {
        return vars;
    }

    let searchingQ = passData({{ result|tojson }});
    let data = passData({{ data|tojson }});
    let editHistory = passData({{ edit|tojson }});
    let erows = passData({{ rows|tojson }});

    function recordData() {
        let record = {
            'data': editList,
            'time': new Date()
        };

        // for recording
        $.ajax({
            type: 'POST',
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(record),
            dataType: 'json',
            url: "/writepin",
            success: function (d) {
                if (d) {
                    console.log('write to the path file successfully.');
                }
            },
            error: function (error) {
                console.log(error.responseText);
            }
        });
    }
</script>
<script src="../static/js/sankey.js"></script>
</body>
</html>